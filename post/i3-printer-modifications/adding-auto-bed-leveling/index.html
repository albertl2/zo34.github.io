<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "http://albertlatham.com"
        },
        "articleSection" : "post",
        "name" : "Duplicator I3 Auto-Bed Leveling with a Smoothieboard.",
        "headline" : "Duplicator I3 Auto-Bed Leveling with a Smoothieboard.",
        "description" : "Thank you for the video, Thomas. I found this video quite a while ago and I decided I&rsquo;d give auto bed-tramming (bed-leveling) a go.
  Final battle with a Melzi. A cursory glance at the Melzi&rsquo;s page on the Reprap website will only begin to illuminate the issues one will face if they attempt to modify the firmware on board in any manner. The Duplicator I3&rsquo;s controller ships with Repetier which didn&rsquo;t support any sort of auto bed-leveling at the time I tried to make this work.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2016",
        "datePublished": "2016-08-15 00:00:00 &#43;0000 UTC",
        "dateModified" : "2016-08-15 00:00:00 &#43;0000 UTC",
        "url" : "http://albertlatham.com/post/i3-printer-modifications/adding-auto-bed-leveling/",
        "wordCount" : "821",
        "image" : http://albertlatham.comheader.jpg",
        "keywords" : [ "Wanhao I3","hardware hacking","3D printing","Blog" ]   
    }
    </script>


 <title>Duplicator I3 Auto-Bed Leveling with a Smoothieboard. </title>


<meta name="description" content="Personal blog and projects." />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">
<link rel="stylesheet" href="http://albertlatham.com/css/font-awesome.min.css" type='text/css' media='all'>

<link href="http://albertlatham.com/css/style.css" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="http://albertlatham.com/css/custom.css" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="http://albertlatham.com/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="http://albertlatham.com/img/favicon.ico" type="image/x-icon">


</head>


<body class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">
  
  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fa fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/build">build</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/design">design</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/recipes">recipes</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    
    <li>
      <a href="https://twitter.com/AlbertLatham" data-animate-hover="pulse" class="twitter" target="_blank">
        <i class="fa fa-twitter-square" title="twitter"></i>
        <span class="screen-reader-text">twitter</span>
      </a>
    </li>
    

    

    
    <li>
      <a href="mailto:albert.m.latham@gmail.com" data-animate-hover="pulse" class="email">
        <i class="fa fa-envelope" title="email"></i>
        <span class="screen-reader-text">email</span>
      </a>
    </li>
    

    
    <li>
      <a href="https://www.linkedin.com/in/albertmlatham/" data-animate-hover="pulse" class="linkedin" target="_blank">
        <i class="fa fa-linkedin" title="linkedin"></i>
        <span class="screen-reader-text">linkedin</span>
      </a>
    </li>
    

    
    <li>
      <a href="https://stackoverflow.com/users/7823006/albert?tab=profile" data-animate-hover="pulse" class="stackoverflow" target="_blank">
        <i class="fa fa-stack-overflow" title="stackoverflow"></i>
        <span class="screen-reader-text">stackoverflow</span>
      </a>
    </li>
    


    
    <li>
      <a href="https://github.com/zo34/" data-animate-hover="pulse" class="github" target="_blank">
        <i class="fa fa-github" title="github"></i>
        <span class="screen-reader-text">github</span>
      </a>
    </li>
    


    

    
    <li>
      <a href="http://albertlatham.com/index.xml" data-animate-hover="pulse" class="rss" target="_blank">
        <i class="fa fa-rss" title="rss"></i>
        <span class="screen-reader-text">rss</span>
      </a>
    </li>
    


  </ul></div>

      </div>

      <div class="container">
        <div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Create, make, break. </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fa fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    
    <p class="site-description">Misadventures of a distracted student.</p>
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-custom menu-item-object-custom '>
          <a href="http://albertlatham.com/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="http://albertlatham.com/contact/">Get in touch</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      
  <div id="loop-container" class="loop-container">
    
    <div class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image' data-background="http://albertlatham.com/post/i3-printer-modifications/adding-auto-bed-leveling/header.jpg">
      </div>
      
        <div class="entry-meta">
          <span class="date">15 August</span>	<span> / </span>

          <span class="author">
            
            <a href="https://albertlatham.com/" title="Posts by Albert Latham" rel="author">Albert Latham</a>
            
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/design">design</a>
          </span>
          
          <span class="category">
            <span> / </span>

            <a href="/categories/build">build</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Duplicator I3 Auto-Bed Leveling with a Smoothieboard.</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              

<h1 id="thank-you-for-the-video-thomas">Thank you for the video, Thomas.</h1>

<p>I found this video quite a while ago and I decided I&rsquo;d give auto bed-tramming (bed-leveling) a go.</p>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/EcGFLwj0pnA" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<h1 id="final-battle-with-a-melzi">Final battle with a Melzi.</h1>

<p>A cursory glance at the Melzi&rsquo;s <a href="http://reprap.org/wiki/Melzi">page</a> on the Reprap website will only begin to illuminate the issues one will face if they attempt to modify the firmware on board in any manner. The Duplicator I3&rsquo;s controller ships with Repetier which didn&rsquo;t support any sort of auto bed-leveling at the time I tried to make this work.</p>

<p>So I figured I&rsquo;d flash Marlin, which does support auto bed-leveling. That was a nightmare that required a specific version of Arduino, special hardware configurations for the Sanguino support, and other things that were nightmarey.</p>

<p>I gave up when I was about 30 hours in and bought a Smoothieboard.</p>

<h1 id="overview">Overview</h1>

<p>I think its useful to look at the whole modification before looking at the grimy details.</p>

<p><img src="the-big-picture.jpg" alt="the whole enchilada" /></p>

<p>The most important things to note about this setup are the locations of the Z-endstop and the inductive sensor.</p>

<ol>
<li>The inductive sensor takes the place of the stock fan. There&rsquo;s a link to the rather uninspired adapter I modeled below.</li>
<li>The Z-endstop has moved from Z-min on the lower left to Z-max on the upper right. I&rsquo;ve included a link to the friction fit adapter below.</li>
</ol>

<h1 id="parts">Parts</h1>

<ul>
<li><a href="http://www.ebay.com/sch/items/?_nkw=LJ12A3-4-Z/BX&amp;_sacat=&amp;_ex_kw=&amp;_mPrRngCbx=1&amp;_udlo=&amp;_udhi=&amp;_sop=12&amp;_fpos=&amp;_fspt=1&amp;_sadis=&amp;LH_CAds=&amp;rmvSB=true">An inductive sensor.</a></li>
<li>Two 10k resistors for 12V systems, or 8.1k and 22k for 24V systems.</li>
<li><a href="inductive_self_leveling_adapter.stl">A handy inductive sensor mount.</a></li>
<li><a href="zmount_frame_bracket_high_right.stl">A friction fit adapter for the new location of the Z-endstop.</a></li>
</ul>

<h1 id="wiring-it-up">Wiring It Up</h1>

<p>Follow Tom&rsquo;s directions for setting up the inductive probe and then you&rsquo;re ready to plug it into the Smoothieboard.</p>

<p><img src="sensor_wired_up.png" alt="inductive sensor wired to smoothieboard" /></p>

<p>If you look <a href="http://smoothieware.org/pinout">here</a> you&rsquo;ll see that</p>

<ol>
<li>GPIO P1.22 is the sensor output.</li>
<li>GND at Z-min just because its convenient. Any ground will do.</li>
<li>12V power the inductive sensor.</li>
</ol>

<p>The complete instructions for setting up the Z-probe for the Smoothieboard can be found <a href="http://smoothieware.org/zprobe">here</a>.</p>

<h1 id="relevant-smoothieboard-configuration">Relevant Smoothieboard Configuration</h1>

<pre><code>## Endstops
endstops_enable                              true             # the endstop module is enabled by default and can be disabled here
#corexy_homing                               false            # set to true if homing on a hbot or corexy
alpha_min_endstop                            1.24^!           # add a ! to invert if endstop is NO connected to ground
alpha_max_endstop                            nc               # NOTE set to nc if this is not installed
alpha_homing_direction                       home_to_min      # or set to home_to_max and set alpha_max
alpha_min                                    0                # this gets loaded after homing when home_to_min is set
alpha_max                                    200              # this gets loaded after homing when home_to_max is set
beta_min_endstop                             1.26^!           #
beta_max_endstop                             nc               #
beta_homing_direction                        home_to_min      #
beta_min                                     0                #
beta_max                                     200              #
gamma_min_endstop                            nc               #
gamma_max_endstop                            1.29^!           #
gamma_homing_direction                       home_to_max      #
gamma_min                                    0                #
gamma_max                                    145.1            #

## Z-probe
zprobe.enable                                true            # set to true to enable a zprobe
zprobe.probe_pin                             1.22^!          # pin probe is attached to if NC remove the !
zprobe.slow_feedrate                         5               # mm/sec probe feed rate
#zprobe.debounce_count                       100             # set if noisy
zprobe.fast_feedrate                         100             # move feedrate mm/sec
zprobe.probe_height                          5               # how much above bed to start probe
#gamma_min_endstop                           nc              # normally 1.28. Change to nc to prevent conflict,

# associated with zprobe the leveling strategy to use
leveling-strategy.three-point-leveling.enable         true        # a leveling strategy that probes three points to define a plane and keeps the Z parallel to that plane
leveling-strategy.three-point-leveling.point1         100.0,0.0   # the first probe point (x,y) optional may be defined with M557
leveling-strategy.three-point-leveling.point2         173.0,160.0 # the second probe point (x,y)
leveling-strategy.three-point-leveling.point3         0.0,160.0   # the third probe point (x,y)
leveling-strategy.three-point-leveling.home_first     true        # home the XY axis before probing
leveling-strategy.three-point-leveling.tolerance      0.03        # the probe tolerance in mm, anything less that this will be ignored, default is 0.03mm
leveling-strategy.three-point-leveling.probe_offsets  -27,-40,2.24       # the probe offsets from nozzle, must be x,y,z, default is no offset
leveling-strategy.three-point-leveling.save_plane     true       # set to true to allow the bed plane to be saved with M500 default is false

</code></pre>

<p>Please don&rsquo;t just copy this blindly. In fact, not all the kinks have been ironed out. I&rsquo;ve still some issues with bed clearance that I haven&rsquo;t tracked down yet.</p>

<p>&lsquo;gamma_max&rsquo; is the Z-max endstop. When setting the value (in mm) make sure to jog your printer as high as it will go and then measure the distance from the nozzle tip to the bed. Subtract a few millimeters and then dial in the exact distance to use. This way you should be able to avoid crashing into your bed like I did. A lot.</p>

<h1 id="on-boot-gcode">on_boot.gcode</h1>

<pre><code>G28 Z ; home z axis
G32 ; level bed (includes x and y axis home)
G0 X127 Y40 ; move to set nozzle height
G92 Z6.1 ; set nozzle height
</code></pre>

<p>This automatically levels the printer every time it turns on. There&rsquo;s an issue that needs to be sorted where the absolute zero coordinates are not the same as the bed leveled coordinates that I haven&rsquo;t managed to figure out yet. At this point I restart the printer if I need to print another object. This isn&rsquo;t ideal, but again, it works.</p>

<ul class="task-list">
<li><label><input type="checkbox" disabled class="task-list-item"> final animation of auto bed-level routine</label></li>
</ul>

            </article>
          </div>
          
      <div class='entry-meta-bottom'>
        

  <div class="entry-categories"><p><span>Categories</span>
    
    <a href="/categories/design" title="View all posts in design">design</a>
    <a href="/categories/build" title="View all posts in build">build</a>
  </p>
</div>



<div class="entry-tags"><p><span>Tags</span>
  
  <a href="/tags/wanhao-i3" title="View all posts tagged Wanhao I3">Wanhao I3</a>
  
  <a href="/tags/hardware-hacking" title="View all posts tagged hardware hacking">hardware hacking</a>
  
  <a href="/tags/3d-printing" title="View all posts tagged 3D printing">3D printing</a>
  

</p></div>	</div>

<div class="author-meta">

  <div class="author">
    <img alt='Albert Latham' src="https://www.gravatar.com/avatar/27697f8045adfbe44b4289113a937624?s=100&d=identicon" class='avatar avatar-72 photo' height='72' width='72'>

    <span>
      Written by:<a href="https://albertlatham.com/" title="Posts by Albert Latham" rel="author">Albert Latham</a>        </span>
    </div>
    <div class="bio">
      
      <p>Albert is a student of electrical engineering and computer science.</p>
      


      

    


  
  <a class="twitter" target="_blank"
  href="https://twitter.com/AlbertLatham">
  <i class="fa fa-twitter-square"
  title="twitter icon"></i>
</a>


<a class="linkedin" target="_blank"
href="https://www.linkedin.com/in/albertmlatham/">
<i class="fa fa-linkedin-square"
title="linkedin icon"></i>
</a>



<a class="email" target="_blank"
href="mailto:albert.m.latham@gmail.com">
<i class="fa fa-envelope"
title="email icon"></i>
</a>





<a class="stackoverflow" target="_blank"
href="https://stackoverflow.com/users/7823006/albert?tab=profile">
<i class="fa fa-stack-overflow"
title="stackoverflow icon"></i>
</a>



<a class="github" target="_blank"
href="https://github.com/zo34/">
<i class="fa fa-github"
title="github icon"></i>
</a>







</div>
</div>

</div>
</div>

<section id="comments" class="comments">
  

  




</section>
</div>

 



    </div>

    <footer id="site-footer" class="site-footer" role="contentinfo">
	<h1>
    
    <a href=""> Create, make, break. </a>
    
	</h1>

			
			<p class="site-description">Misadventures of a distracted student.</p>
			

		<div id="menu-footer" class="menu-container menu-footer" role="navigation">
		<div class="menu">

      <ul id="menu-footer-items" class="menu-footer-items">
        
</ul>

</div>	</div>

<ul class="social-media-icons">

        

        


        
        <li>
        <a href="https://twitter.com/AlbertLatham"  class="twitter" target="_blank">
            <i class="fa fa-twitter-square" title="twitter"></i>
            <span class="screen-reader-text">twitter</span>
        </a>
        </li>
        

        

        
        <li>
        <a href="mailto:albert.m.latham@gmail.com"  class="email">
            <i class="fa fa-envelope" title="email"></i>
            <span class="screen-reader-text">email</span>
        </a>
        </li>
        

        
        <li>
        <a href="https://www.linkedin.com/in/albertmlatham/" class="linkedin" target="_blank">
            <i class="fa fa-linkedin" title="linkedin"></i>
            <span class="screen-reader-text">linkedin</span>
        </a>
        </li>
        

        
        <li>
        <a href="https://stackoverflow.com/users/7823006/albert?tab=profile"  class="stackoverflow" target="_blank">
            <i class="fa fa-stack-overflow" title="stackoverflow"></i>
            <span class="screen-reader-text">stackoverflow</span>
        </a>
        </li>
        


        
        <li>
        <a href="https://github.com/zo34/"  class="github" target="_blank">
            <i class="fa fa-github" title="github"></i>
            <span class="screen-reader-text">github</span>
        </a>
        </li>
        


        

        
        <li>
        <a href="http://albertlatham.com/index.xml" data-animate-hover="pulse" class="rss" target="_blank">
            <i class="fa fa-rss" title="rss"></i>
            <span class="screen-reader-text">rss</span>
        </a>
        </li>
        

				</ul>	<div class="design-credit">
		
		<p>&copy; 2018 Albert Latham</p>
		
		<p>Nederburg Hugo Theme by <a href="https://appernetic.io">Appernetic</a>.</p>
		
		<p>A port of Tracks by Compete Themes.</p>
		
	</div>
</footer>

  </div>
  <script src="http://albertlatham.com/js/jquery.min.js"></script>
<script src="http://albertlatham.com/js/jquerymigrate.js"></script>
<script src="http://albertlatham.com/js/production.min.js"></script>

</body>
</html>
